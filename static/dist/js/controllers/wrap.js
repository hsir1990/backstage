var app=angular.module("app");app.controller("wrapCtrl",["$scope","$location","xhr",function(e,t,n){function u(e){var t=[],n=function(e,t,u){$.each(t,function(o,a){"undefined"==typeof a.submenu&&(a.submenu=[]),a.parent_id==e&&(u.push(a),n(a.id,t,a.submenu))})};return n(0,e,t),t}e.userName="",e.identityName="",e.identityCompetence="",e.isSupperUser=!1,e.noticeCount=0,e.menuList=[],e.logout=function(){n.ajax({method:"POST",url:"/user/logout"}).success(function(e){1==e.code?(window.CHAT&&window.CHAT.logout(),t.url("/login")):H.alert(e.msg)}).error(function(){H.alert("数据请求失败！")})},n.ajax({method:"GET",url:"/user/msg",params:{userId:H.Cookie.get("userId")}}).success(function(o){1==o.code?(e.userName=o.data.user_real_name,e.identityName=o.data.identity_name,e.identityCompetence=o.data.identity_competence,"*"==o.data.identity_competence&&(e.isSupperUser=!0),n.ajax({method:"GET",url:"/menu/list"}).success(function(t){1==t.code&&(e.menuList=u(t.data))})):t.url("/login")})}]);