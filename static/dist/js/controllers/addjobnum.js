var app=angular.module("app");app.controller("addjobnumCtrl",["$scope","$location","$timeout","xhr",function(a,e,r,o){function s(e){a.errMsg=e,r.cancel(t),t=r(function(){a.errMsg=""},3e3)}var t=null;a.userName="",a.password="",a.errMsg="";var u=!0;a.login=function(){return""==a.userName?void s("请输入用户名！"):""==a.password?void s("请输入密码！"):void(u&&(u=!1,o.ajax({method:"POST",url:"/user/validate",data:{name:a.userName,password:a.password},dataType:"json"}).success(function(r){1==r.code?o.ajax({method:"POST",url:"/user/addJobNumber",data:{userName:H.Storage.get("userNameCha"),staff_no:a.userName}}).success(function(a){H.Storage.set("userName",H.Storage.get("userNameCha")),u=!0,e.url("/platform/main")}).error(function(){u=!0,H.alert("数据请求失败！")}):(u=!0,s(r.msg))}).error(function(){H.alert("数据请求失败！")})))}}]);