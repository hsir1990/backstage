var app=angular.module("app");app.directive("fitScreen",function(){return{restrict:"A",link:function(e,t,a,n){$(t).height($(window).height())}}}),app.directive("realTime",function(){return{restrict:"A",link:function(e,t,a,n){}}}),app.directive("wrapFit",function(){return{restrict:"A",link:function(e,t,a,n){window.wrapMod||(window.wrapMod={clickX:0,clickY:0,mainScroll:null,tabScroll:null,subScroll:null,eventFlag:!1,init:function(){var e=this;e.setContMinHeight(),e.tabScroll=new iScroll("J-frame-tab",{snap:"li",bounce:!1,bounceLock:!1,momentum:!0,hideScrollbar:!0,hScroll:!0,vScroll:!1,hScrollbar:!1,vScrollbar:!1,onBeforeScrollStart:function(e){e.preventDefault()}}),e.eventFlag||e.addEvents()},setContMinHeight:function(){var e=this,t=$(window).height()-$("#J-header").outerHeight()-$("#J-footer").outerHeight(),a=t-$("#J-frame-tab").outerHeight();$("#J-sidebar, #J-submenu-wrap").height(t),$("#J-container").height(a),e.mainScroll&&e.mainScroll.refresh()},showPage:function(e){var t=this;if(window.frames[e.target]){var a=$("#J-frame-tab").find("li[data-name="+e.target+"]");a.addClass("active").siblings().removeClass("active"),t.tabScroll&&t.tabScroll.scrollToElement(a[0]),window.frames[e.target].location.href=e.href+"?token="+H.Cookie.get("userToken")}else{var n=document.createElement("iframe"),i=$("#J-frame-tab").find("ul.inner"),r=H.Storage.get("version");n.className="iframe",n.frameborder=0,n.scrolling="auto",n.name=e.target,n.src=e.href+"?token="+H.Cookie.get("userToken")+"&v="+r,$("#J-container").append(n),i.find("li").removeClass("active"),i.append('<li class="item active" data-name="'+e.target+'">'+e.name+"</li>").width(i.find("li").length*i.find("li").outerWidth()),t.tabScroll&&t.tabScroll.refresh(),t.tabScroll&&t.tabScroll.scrollToElement(i.find("li").last()[0])}$("#J-container").find("iframe").width(0).height(0).css("position","absolute"),$("#J-container").find("iframe[name="+e.target+"]").width("100%").height("100%").css("position","relative")},addEvents:function(){var e=this;$(document).on("mouseover","#J-sidebar li",function(e){var t=$(this);t.addClass("active"),t.hasClass("J-has-submenu")?($("#J-submenu-wrap").show().html(t.find("ul.J-submenu").clone()),wrapMod.subScroll=null,wrapMod.subScroll=new iScroll("J-submenu-wrap",{snap:"li",bounce:!1,bounceLock:!1,momentum:!0,hideScrollbar:!0,onBeforeScrollStart:function(e){e.preventDefault()}})):$("#J-submenu-wrap").hide()}).on("mouseleave","#J-sidebar li",function(e){var t=$(this),a=e.toElement?$(e.toElement):$(e.relatedTarget);t.removeClass("active"),a.closest("#J-submenu-wrap").length<1&&$("#J-submenu-wrap").hide()}).on("mouseleave","#J-submenu-wrap",function(e){var t=$(e.toElement);t.closest("#J-sidebar li.J-has-submenu").length<1&&$(this).hide()}).on("click","#J-submenu-wrap div.J-can-open",function(e){var t=$(this),a=function(){wrapMod.subScroll&&wrapMod.subScroll.refresh()};t.hasClass("active")?t.removeClass("active").next().slideUp(50,a):t.addClass("active").next().slideDown(50,a)}).on("click","#J-sidebar a, #J-submenu-wrap a",function(e){"_blank"!=e.target.target&&e.preventDefault()}).on("mousedown","#J-sidebar a, #J-submenu-wrap a",function(e){wrapMod.clickY=e.pageY}).on("mouseup","#J-sidebar a, #J-submenu-wrap a, #J-link-change-pwd",function(t){Math.abs(wrapMod.clickY-t.pageY)<50&&(H.Cookie.get("userToken")?"_blank"!=t.target.target&&e.showPage({target:t.target.target,href:t.target.href,name:t.target.name}):location.href="/#/login")}).on("mousedown","#J-frame-tab li",function(e){wrapMod.clickX=e.pageX}).on("mouseup","#J-frame-tab li",function(e){if(Math.abs(wrapMod.clickX-e.pageX)<50){var t=$(e.target);t.hasClass("active")||(t.addClass("active").siblings().removeClass("active"),$("#J-container").find("iframe").width(0).height(0).css("position","absolute"),$("#J-container").find("iframe[name="+t.data("name")+"]").width("100%").height("100%").css("position","relative"))}}).on("dblclick","#J-frame-tab li",function(t){var a=$(t.target),n=a.parent();"home"!=a.data("name")&&(a.prev().addClass("active").end().remove(),n.width(n.find("li").length*n.find("li").outerWidth()),$("#J-container").find("iframe[name="+a.data("name")+"]").prev().width("100%").height("100%").css("position","relative").end().remove(),e.tabScroll&&e.tabScroll.refresh())}),$(window).on("resize",function(){wrapMod.setContMinHeight()}),wrapMod.eventFlag=!0}}),wrapMod.init()}}}),app.directive("setSideScroll",function(){return{restrict:"A",link:function(e,t,a,n){wrapMod.mainScroll=new iScroll("J-sidebar",{snap:"li",bounce:!1,bounceLock:!1,momentum:!0,hideScrollbar:!0,onBeforeScrollStart:function(e){e.preventDefault()}})}}});